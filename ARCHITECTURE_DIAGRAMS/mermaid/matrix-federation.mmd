graph LR
    subgraph "Home Server A"
        HS_A[ðŸ  Home Server A]
        Client_A[ðŸ‘¤ Client A]
        KeyStore_A[ðŸ”‘ Key Store A]
    end

    subgraph "Home Server B"
        HS_B[ðŸ  Home Server B]
        Client_B[ðŸ‘¤ Client B]
        KeyStore_B[ðŸ”‘ Key Store B]
    end

    subgraph "Federation"
        PFS[Federation Protocol]
        Relay[ðŸ•Šï¸ Relay Service]
    end

    Client_A --> HS_A
    HS_A --> PFS
    PFS --> Relay
    Relay --> PFS
    PFS --> HS_B
    HS_B --> Client_B

    KeyStore_A -.-> Client_A
    KeyStore_B -.-> Client_B

    Note over HS_A,HS_B: Encrypted Federation via<br/> Olm/Megolm Protocol

    style HS_A fill:#42a5f5
    style HS_B fill:#42a5f5
    style Client_A fill:#66bb6a
    style Client_B fill:#66bb6a
    style PFS fill:#ffa726
    style Relay fill:#ffa726

